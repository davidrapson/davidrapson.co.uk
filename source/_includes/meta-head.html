<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">

    <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">
    <link rel="alternate" type="application/atom+xml" title="{{ site.title }}" href="{{ "/feed.xml" | prepend: site.baseurl | prepend: site.url }}" />

    <meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}"/>
    <meta property="og:site_name" content="{{ site.title }}"/>
    <meta property="og:url" content="{{ page.url }}"/>
    <meta property="og:description" content="{{ page.excerpt | strip_html | strip_newlines }}"/>

    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png">
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <meta name="theme-color" content="#b60000">

    <style>{% include style.css %}</style>

    <script id="script-config">
        window.Config = {
            isModern: (
                'querySelector' in document &&
                'localStorage' in window &&
                'addEventListener' in window &&
                'withCredentials' in new XMLHttpRequest()
            )
        };
    </script>
    <script id="script-usertime">
        {% include markUserTime.js %}
    </script>
    <script src="https://use.typekit.net/bem2aeh.js"></script>
    <script id="script-setup">
        {% include fontFaceObserver.js %}

        (function(isModern) {
            var docEl = document.documentElement;
            var classes = ['js'];

            /**
             * Loads web-fonts using FontFaceObserver
             *
             * Minimises Flash of Faux Text (FOFT) by storing
             * loaded preference in localStorage and adding
             * a fonts-loaded class earlier if we think the
             * fonts are already cached.
             */
            function loadFonts() {
                var fontsLoaded = false;
                var fontClass = 'fonts-loaded';

                var observerBody = new FontFaceObserver('ff-meta-web-pro');
                var observerDisplay = new FontFaceObserver('ff-meta-web-pro-condensed');

                try {
                    fontsLoaded = !!sessionStorage.getItem('fontsLoaded')
                } catch(e) {}

                if (fontsLoaded) {
                    // Sync so push the class in to the array.
                    // Avoids setting docEl.className more than we need to.
                    classes.push(fontClass);
                }

                try {
                    Typekit.load({
                        async: !fontsLoaded,
                        classes: false
                    });
                } catch(e) {}

                Promise.all([
                    observerBody.load(),
                    observerDisplay.load()
                ]).then(function() {
                    if (!fontsLoaded) {
                        // Async, so we need to add the class manually.
                        docEl.className = docEl.className + ' ' + fontClass;
                        try {
                            sessionStorage.setItem('fontsLoaded', true);
                        } catch(e) {}
                    }
                });
            }

            loadFonts();

            docEl.className = docEl.className.replace('no-js', '') + classes.join(' ');
        }(Config.isModern));
    </script>

    <script id="script-sw">
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js');
        }
    </script>
    <script>window.markUserTime('aft.Head')</script>

</head>
